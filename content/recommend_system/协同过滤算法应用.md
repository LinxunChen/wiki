---
title: 协同过滤算法应用
date: 2017-01-04 22:40:10
---
[TOC]

## 经典的基于行为的协同过滤算法
### user-based cf
<img src="http://oa5sa0jqw.bkt.clouddn.com/9ca075f9e66cb7e86b3434b4f8d69161.png" width = "350" height = "310" alt="user-based cf"/>

### item-based cf
<img src="http://oa5sa0jqw.bkt.clouddn.com/9e33bec9b1b1c5bfdc72ef81355053c0.png" width = "350" height = "310" alt="item-based cf"/>

## 相似度计算
相似度的计算通常可以基于余弦相似度、皮尔逊系数、欧几里得距离等等。
### 皮尔逊系数
皮尔逊系数是介于-1到1之间的值，用来描述两组线性的数据一同变化移动的趋势。线性正相关时值为1，无线性相关关系时值为0。计算公式[[参考](http://blog.csdn.net/wenbingoon/article/details/17414063)]：
$$
r = \frac{cov(X,Y)}{\sigma_X\sigma_Y} = \frac{E[(X-\mu_X)(Y-\mu_Y)]}{\sigma_X\sigma_Y} = \frac{\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^n (x_i-\bar{x})^2}\sqrt{\sum_{i=1}^n (y_i-\bar{y})^2}}
$$
### 修正的余弦相似度与皮尔逊系数比较
两者差别在于去中心化的方式上[[参考](https://www.zhihu.com/question/21824291)]：  
修正cosine相似度的目的是解决cosine相似度仅考虑向量维度方向上的相似而没考虑到各个维度的量纲的差异性，所以在计算相似度的时候，做了每个维度减去均值的修正操作。本文最上面中itemCF即是用的修正余弦相似度。  
Pearson correlation 相关系数主要考虑线性相关性，定义为两个变量之间的协方差和标准差的商，所以自然的考虑了均值的修正操作。  

通常itemCF用修正的余弦相似度，userCF用皮尔逊系数相似度，两者减去的均值都是每个用户的打分均值。

### 热门降权
以userCF为例，两个用户对冷门物品采取过同样的行为更能说明他们兴趣的相似度，因此在计算相似度的时候，对分子中热门物品的贡献进行降权，是一种有效的优化策略。  
可以对分子中每项乘以
$\frac{1}{\log1+|N(i)|}$，
其中
$|N(i)|$
表征了物品的热门程度。  
降权也可以在UI行为分计算的时候进行，效果等价。

## 协同过滤的应用
### 召回
协同过滤算法目前主要应用在召回模块中，通常应用场景有：
- 为用户离线或在线产出推荐物品列表，推荐容器在线加载。
- 产出物品相似度表，当用户实时点击/点赞物品时，可以将其相似的物品进行召回。在最近的实验中发现效果很赞。
- 协同召回除了基于行为，还可以基于其他维度进行协同关系的计算。比如，可以通过“用户-圈子”分数来计算用户的相似度，通过“文章-职业”分数来计算文章相似度等等。

### 排序
协同过滤算法并不是很精细的算法，一般很少直接用于排序。目前了解到的，可将协同算法计算出的UI分数，作为排序模型的特征来使用，有一定的效果。
